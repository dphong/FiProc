<!DOCTYPE html>  
{% load bootstrap3  %} 
{% load staticfiles %} 
<html lang="en">  
<head>  
    <meta charset="utf-8">  
    <title>合肥师范学院单据报销</title>
    <meta name="description" content="">  
    <link rel="stylesheet" type="text/css" href="{% static 'FiProcess/bootstrap.min.css' %}" /> 
    <script type="text/javascript" src="{% static 'FiProcess/jquery-2.2.4.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'FiProcess/bootstrap.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'FiProcess/validator.js' %}"></script>
    <style type="text/css">
    </style>
    <script type="text/javascript">
    function cardHolder(prefix, i){
        return "<td>\
                <div class='form-group has-feedback'>\
                    <input name='"+prefix+"_cardHolderName"+i+"' type='text' placeholder='持卡人姓名' required\
                        class='form-control input-md col-md-1'>\
                </div>\
            </td>\n";
    }
    function amount(prefix, i){
        return "<td>\
                <div class='form-group has-feedback'>\
                    <input name='"+prefix+"_amount"+i+"' type='text' placeholder='' required\
                        class='form-control input-md'>\
                </div>\
            </td>\n";
    }
    function cardNum(prefix, i){
        return "<td>\
                <div class='form-group has-feedback'>\
                    <input pattern='^[0-9]{8,}$' maxlength='16' required\
                        name='"+prefix+"_account"+i+"' type='text' placeholder='' class='form-control input-md'>\
                </div>\
            </td>\n";
    }
    function bankName(prefix, i){
        return "<td>\
                <div class='form-group has-feedback'>\
                    <input name='"+prefix+"_bankName"+ i + "' type='text' placeholder='' required\
                        class='form-control input-md'>\
                </div>\
            </td>\n";
    }
    function spendTypes(prefix, i){
        return "<td class='form-group has-feedback col-md-2'>\
            <select name='"+prefix+"_spendType"+i+"' class='form-control'>\
                <option value='1'>办公用品</option>\
                <option value='2'>书报资料</option>\
                <option value='3'>印刷费</option>\
                <option value='4'>邮电费</option>\
                <option value='5'>住宿费</option>\
                <option value='6'>出国费</option>\
                <option value='7'>维修维护</option>\
                <option value='8'>医疗费</option>\
                <option value='9'>会议费</option>\
                <option value='10'>培训费</option>\
                <option value='11'>招待费</option>\
                <option value='12'>交通费</option>\
                <option value='13'>专用材料</option>\
                <option value='14'>设备购置</option>\
                <option value='15'>其它</option>\
            </select></td>";
    }
    $(document).ready(function(){
        var i=1;
        $("#add_row").click(function(){
            $('#tab_icbcCard').append('<tr id="addr'+i+'"></tr>');
            $('#addr'+i).html(
                "<td>"+ i +"</td>\n" + cardHolder('icbc', i) +
                "<td>\
                    <div class='form-group has-feedback'>\
                        <input name='icbc_date"+i+"' type='text' placeholder='YYYY-mm-dd' required\
                            class='form-control input-md'>\
                    </div>\
                </td>\n" + amount('icbc', i) + 
                "<td>\
                    <div class='form-group has-feedback'>\
                        <input name='icbc_actualAmount"+i+"' type='text' placeholder='' required\
                            class='form-control input-md'>\
                    </div>\
                </td>\n" + cardNum('icbc', i) + spendTypes('icbc', i));
            i++; 
            $('#streamForm').validator()
        });
        $("#delete_row").click(function(){
            if(i>1){
                $("#addr"+(i-1)).html('');
                i--;
                $('#streamForm').validator()
            }
        });
        var i_ccb = 1;
        $("#add_row_ccb").click(function(){
            $('#tab_ccbCard').append('<tr id="addr_ccb'+i_ccb+'"></tr>');
            $('#addr_ccb'+i_ccb).html(
                "<td>"+i_ccb+"</td>\n" + cardHolder('ccb', i_ccb) + amount('ccb', i_ccb) + cardNum('ccb', i_ccb) 
                    + bankName('ccb', i_ccb) + spendTypes('ccb', i) +"</td>");
            i_ccb++;
            $('#streamForm').validator()
        })
        $("#delete_row_ccb").click(function(){
            if(i_ccb>1){
                $("#addr_ccb"+(i_ccb-1)).html('');
                i_ccb--;
                $('#streamForm').validator()
            }
        })
        var i_com = 1;
        $("#add_row_com").click(function(){
            $('#tab_companyAccount').append('<tr id="addr_com' + i_com + '"></tr>');
            $('#addr_com'+i_com).html(
                "<td>"+i_com+"</td>\n" + cardHolder('company', i_com) + amount('company', i_com) + cardNum('company', i_com) 
                    + bankName('company', i_com) + spendTypes('company', i) + "</td>");
            i_com++;
            $('#streamForm').validator()
        })
        $('#delete_row_com').click(function(){
            if(i_com>1){
                $("#addr_com"+(i_com-1)).html('');
                i_com--;
                $('#streamForm').validator()
            }
        })
    })
    </script>
</head>

<body>
    <div class="container" style="max-width:1000px">
    {% if errorMsg %}
        <div class="alert alert-danger">  
            <button type="button" class="close" data-dismiss="alert">×</button>  
            <h4>{{errorMsg}}</h4>  
        </div>  
    {% endif %}
    {% if warningMsg %}
        <div class="alert alert-info">  
            <button type="button" class="close" data-dismiss="alert">×</button>  
            <h4>{{warningMsg}}</h4>  
        </div>  
    {% endif %}
    <form id="streamForm" data-toggle="validator" role="form" lass="form" action="" method="post" style="margin:20px 0px 0px 0px">
        {% csrf_token %}
        <div class="form-group">  
            <input name="commonStreamForm" type="submit" class="btn btn-primary" value="创建"></input>
        </div>
        <div class="well">
            <h3 align="center"><strong>合肥师范学院单据报销</strong></h3>
            <div class="row">
                <div class="form-group col-md-3">
                    {% bootstrap_field form.department %}
                </div>
                <div class="form-group col-md-3">
                    {% bootstrap_field form.name %}
                </div>
                <div class="form-group col-md-3">
                    {% bootstrap_field form.workId %}
                </div>
                <div class="form-group col-md-3">
                    {% bootstrap_field form.applyDate %}
                </div>
            </div>
            <div class="row">
                <div class="form-group col-md-3">
                    {% bootstrap_field form.supportDept %}
                </div>
                <div class="form-group col-md-9">
                    {% bootstrap_field form.projectName %}
                </div>
            </div>
            <div class="form-group">
                {% bootstrap_field form.streamDiscript %}
            </div>
            <div class="row">
                <div class="form-group col-md-3">
                    {% bootstrap_field form.projectLeaderName %}
                </div>
                <div class="form-group col-md-3">
                    {% bootstrap_field form.projectLeaderWorkId %}
                </div>
            </div>
            <div class="form-group"></div>
            <label for="tab_icbcCard" class="control-label">公务卡刷卡记录</label>
            <table class="table table-bordered table-hover" id="tab_icbcCard">
                <thead>
                    <tr>
                        <th class="text-center">#</th>
                        <th class="text-center">持卡人姓名</th>
                        <th class="text-center">消费日期</th>
                        <th class="text-center">消费金额</th>
                        <th class="text-center">实报金额</th>
                        <th class="text-center">公务卡号</th>
                        <th class="text-center">开支类别</th>
                    </tr>
                </thead>
                <tbody>
                {% for item in list %}
                    <tr id="addr{{ forloop.counter }}">
                        <td>{{forloop.counter}}</td>
                        <td><div class='form-group has-feedback'>
                            <input name='icbc_cardHolderName{{ forloop.counter }}' type='text' placeholder='持卡人姓名' required
                                value="{{ item.name }}" class='form-control input-md col-md-1'>
                        </div></td>
                        <td><div class='form-group has-feedback'>
                            <input name='icbc_date{{ forloop.counter }}' type='text' placeholder='YYYY-mm-dd' required
                                value="{{ item.date }}" class='form-control input-md'>
                        </div></td>
                        <td><div class='form-group has-feedback'>
                            <input name='icbc_amount{{ forloop.counter }}' type='text' placeholder='' required
                                value="{{ item.amount }}" class='form-control input-md'>
                        </div></td>
                        <td><div class='form-group has-feedback'>
                            <input name='icbc_actualAmount{{ forloop.counter }}' type='text' placeholder='' required
                                value="{{ item.actualAmount }}" class='form-control input-md'>
                        </div></td>
                        <td><div class='form-group has-feedback'>
                            <input pattern='^[0-9]{8,}$' maxlength='16' required
                                name='icbc_account{{ forloop.counter }}' type='text' placeholder='' 
                                value="{{ item.icbcCard }}" class='form-control input-md'>
                        </div></td>
                        <td class="col-md-2"><div class='form-group has-feedback'>
                            <select name='icbc_spendType{{ forloop.counter }}' class='form-control'>
                                {% ifequal item.payType '1' %}
                                <option selected="selected" value='1'>办公用品</option>
                                {% else %}
                                <option value='1'>办公用品</option>
                                {% endifequal %}
                                {% ifequal item.payType '2' %}
                                <option selected="selected" value='2'>书报资料</option>
                                {% else %}
                                <option value='2'>书报资料</option>
                                {% endifequal %}
                                {% ifequal item.payType '3' %}
                                <option selected="selected" value='3'>印刷费</option>
                                {% else %}
                                <option value='3'>印刷费</option>
                                {% endifequal %}
                                {% ifequal item.payType '4' %}
                                <option selected="selected" value='4'>邮电费</option>
                                {% else %}
                                <option value='4'>邮电费</option>
                                {% endifequal %}
                                {% ifequal item.payType '5' %}
                                <option selected="selected" value='5'>住宿费</option>
                                {% else %}
                                <option value='5'>住宿费</option>
                                {% endifequal %}
                                {% ifequal item.payType '6' %}
                                <option selected="selected" value='6'>出国费</option>
                                {% else %}
                                <option value='6'>出国费</option>
                                {% endifequal %}
                                {% ifequal item.payType '7' %}
                                <option selected="selected" value='7'>维修维护</option>
                                {% else %}
                                <option value='7'>维修维护</option>
                                {% endifequal %}
                                {% ifequal item.payType '8' %}
                                <option selected="selected" value='8'>医疗费</option>
                                {% else %}
                                <option value='8'>医疗费</option>
                                {% endifequal %}
                                {% ifequal item.payType '9' %}
                                <option selected="selected" value='9'>会议费</option>
                                {% else %}
                                <option value='9'>会议费</option>
                                {% endifequal %}
                                {% ifequal item.payType '10' %}
                                <option selected="selected" value='10'>培训费</option>
                                {% else %}
                                <option value='10'>培训费</option>
                                {% endifequal %}
                                {% ifequal item.payType '11' %}
                                <option selected="selected" value='11'>招待费</option>
                                {% else %}
                                <option value='11'>招待费</option>
                                {% endifequal %}
                                {% ifequal item.payType '12' %}
                                <option selected="selected" value='12'>交通费</option>
                                {% else %}
                                <option value='12'>交通费</option>
                                {% endifequal %}
                                {% ifequal item.payType '13' %}
                                <option selected="selected" value='13'>专用材料</option>
                                {% else %}
                                <option value='13'>专用材料</option>
                                {% endifequal %}
                                {% ifequal item.payType '14' %}
                                <option selected="selected" value='14'>设备购置</option>
                                {% else %}
                                <option value='14'>设备购置</option>
                                {% endifequal %}
                                {% ifequal item.payType '15' %}
                                <option selected="selected" value='15'>其它</option>
                                {% else %}
                                <option value='15'>其它</option>
                                {% endifequal %}
                            </select>
                        </div></td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
            <div class="row">
                <div class="col-md-1">
                    <a id="add_row" class="btn btn-default">增加一条记录</a>
                </div>
                <div class="col-md-9"></div>
                <div class="col-md-1">
                    <a id='delete_row' class="btn btn-default">删除一条记录</a>
                </div>
            </div>
            <label for="tab_ccbCard" class="control-label">现金支付记录</label>
            <table class="table table-bordered table-hover" id="tab_ccbCard">
                <thead>
                    <tr>
                        <th class="text-center">#</th>
                        <th class="text-center">持卡人姓名</th>
                        <th class="text-center">报销金额</th>
                        <th class="text-center">卡号</th>
                        <th class="text-center">开户行</th>
                        <th class="text-center">开支类别</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
            <div class="row">
                <div class="col-md-1">
                    <a id="add_row_ccb" class="btn btn-default">增加一条记录</a>
                </div>
                <div class="col-md-9"></div>
                <div class="col-md-1">
                    <a id='delete_row_ccb' class="btn btn-default">删除一条记录</a>
                </div>
            </div>
            <label for="tab_companyAccount" class="control-label">对公转账</label>
            <table class="table table-bordered table-hover" id="tab_companyAccount">
                <thead>
                    <tr>
                        <th class="text-center">#</th>
                        <th class="text-center">收款单位</th>
                        <th class="text-center">报销金额</th>
                        <th class="text-center">卡号</th>
                        <th class="text-center">开户行</th>
                        <th class="text-center">开支类别</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
            <div class="row">
                <div class="col-md-1">
                    <a id="add_row_com" class="btn btn-default">增加一条记录</a>
                </div>
                <div class="col-md-9"></div>
                <div class="col-md-1">
                    <a id='delete_row_com' class="btn btn-default">删除一条记录</a>
                </div>
            </div>
        </div>
    </form>
    <a href={% url 'index' '' %} class="btn btn-large btn-default">返回</a>
    </div>
</body>
</html>
