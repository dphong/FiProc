<!DOCTYPE html>  
{% load bootstrap3  %} 
{% load staticfiles %} 
<html lang="en">  
<head>  
    <meta charset="utf-8">  
    <title>财务报账审批系统</title>  
    <meta name="description" content="">  
    <link rel="stylesheet" type="text/css" href="{% static 'FiProcess/bootstrap.min.css' %}" /> 
    <script type="text/javascript" src="{% static 'FiProcess/jquery-2.2.4.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'FiProcess/bootstrap.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'FiProcess/validator.min.js' %}"></script>
    <style type="text/css">
    </style>
    <script type="text/javascript">
    $(document).ready(function(){
        $('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
            var target = $(e.target).attr("href") // activated tab
            var xmlhttp = new XMLHttpRequest();;
            alert({% url 'index' %} + target);
            xmlhttp.open("GET", {% url 'index' %} + target, true);
            xmlhttp.send();
            window.location.reload();
        });
    });
    </script>
</head>  

<body>  
    <div class="container">
        <h2>财务报账审批系统</h2>
        <ul class="nav nav-tabs">
            <li class="active"><a data-toggle="tab" href="user">个人信息</a></li>
            <li><a data-toggle="tab" href="order">报销单</a></li>
            <li><a data-toggle="tab" href="changepsw">修改密码</a></li>
            {% if signer %}
            <li><a data-toggle="tab" href="signList">待审批单据</a></li>
            {% endif %}
            {% if sys_admin %}
            <li><a data-toggle="tab" href="stuffCheck">用户注册申请</a></li>
            {% endif %}
            <form class="form" method="post">
                {% csrf_token %}  
                <button type="submit" name="logout" class="btn btn-primary navbar-btn pull-right">注销</button>
            </form>
        </ul>

        <div class="tab-content">
        {% if userInfoForm %}
            {% if saveFailedMsg %}
                <div class="alert alert-danger">
                    <button type="button" class="close" data-dismiss="alert">×</button>  
                    <h4>保存失败, {{saveFailedMsg}}</h4>
                </div>
            {% endif %}
            {% if saveSuccess %}
                <div class="alert alert-success">  
                    <button type="button" class="close" data-dismiss="alert">×</button>  
                    <h4>保存成功</h4>  
                </div>  
            {% endif %}
            <form data-toggle="validator" role="form" class="form" action="" method="post">  
                {% csrf_token %}  
                <div>
                    {% bootstrap_field userInfoForm.username %}
                </div>
                <div>
                    {% bootstrap_field userInfoForm.name %}
                </div>
                <div>
                    {% bootstrap_field userInfoForm.workId %}
                </div>
                <div>
                    {% bootstrap_field userInfoForm.department %}
                </div>
                <div class="form-group has-feedback">
                    <label for="inputPhoneNumber" class="control-label">联系电话</label>
                    <input type="text" pattern="^[-0-9]{4,}$" class="form-control" id="inputPhoneNumber"
                        name="phoneNumber" required placeholder="请输入固化或手机号码"
                        value={{userInfoForm.phoneNumber.value}}>
                    <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                </div>
                <div class="form-group has-feedback">
                    <label for="inputIcbcCard" class="control-label">公务卡号</label>
                    <input type="text" pattern="^[0-9]{8,}$" maxlength="8" class="form-control" id="inputIcbcCard"
                        name="icbcCard" placeholder="请输入16位公务卡卡号"
                        value={{userInfoForm.icbcCard.value}}>
                    <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                </div>
                <div class="form-group has-feedback">
                    <label for="inputCcbCard" class="control-label">工资卡号</label>
                    <input type="text" pattern="^[0-9]{6,}$" maxlength="24" class="form-control" id="inputCcbCard"
                        name="ccbCard" placeholder="请输入工资卡号或其他用于转账的卡号"
                        value={{userInfoForm.ccbCard.value}}>
                    <span class="glyphicon form-control-feedback" aria-hidden="true"></span>
                </div>
                <div class="form-group">
                    <label for="inputPsw" class="control-label">设置登录密码</label>
                    <input type="password" data-minlength="6" maxlength="64" class="form-control" id="inputPsw" 
                        name="password" required placeholder="修改信息请输入密码">
                </div>
                <div class="form-group">  
                    <button type="submit" name="saveUserInfo" class="btn btn-primary">保存信息</button>
                </div>
            </form>
        {% endif %}
        {% if changePsw %}
        <form data-toggle="validator" role="form" class="form" action="" method="post">  
            {% csrf_token %}  
            <div class="form-group">
                <label for="changePsw" class="control-label">设置登录密码</label>
                <input type="password" data-minlength="6" maxlength="64" class="form-control" id="changePsw" 
                    name="password" required placeholder="请输入不少于6位密码">
                <label for="confirmPsw" class="contorl-label">确认密码</label>
                <input type="password" class="form-control" id="confirmPsw" required data-match="#changePsw" data-match-error="两次输入不一致">
                <div class="help-block with-errors"></div>
            </div>
            <div class="form-group">
                <button type="submit" name="changePassword" class="btn btn-primary">提交更改</button>
            </div>
        </form>
        {% endif %}

        </div>
    </div>
</body>
</html>